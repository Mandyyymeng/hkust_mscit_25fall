nohup: ignoring input
2025-11-02 00:03:12.344 | INFO     | __main__:<module>:562 - ==================================================
2025-11-02 00:03:12.344 | INFO     | __main__:<module>:563 - Starting Step 1: LSH Index Construction
2025-11-02 00:03:12.485 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database california_schools already exists, skipping...
2025-11-02 00:03:12.558 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database toxicology already exists, skipping...
2025-11-02 00:03:12.921 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database formula_1 already exists, skipping...
2025-11-02 00:03:13.137 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database superhero already exists, skipping...
2025-11-02 00:03:13.472 | WARNING  | alphasql.database.utils:load_foreign_keys:90 - Target column is None and has been fixed by primary keys of target table League - id, source table: Match, source column: league_id
2025-11-02 00:03:13.473 | WARNING  | alphasql.database.utils:load_foreign_keys:90 - Target column is None and has been fixed by primary keys of target table Country - id, source table: Match, source column: country_id
2025-11-02 00:03:13.826 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database european_football_2 already exists, skipping...
2025-11-02 00:03:14.850 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database card_games already exists, skipping...
2025-11-02 00:03:14.955 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database financial already exists, skipping...
2025-11-02 00:03:15.008 | WARNING  | alphasql.database.utils:load_foreign_keys:90 - Target column is None and has been fixed by primary keys of target table customers - CustomerID, source table: yearmonth, source column: CustomerID
2025-11-02 00:03:15.008 | WARNING  | alphasql.database.utils:load_foreign_keys:90 - Target column is None and has been fixed by primary keys of target table customers - CustomerID, source table: yearmonth, source column: CustomerID
2025-11-02 00:03:15.020 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database debit_card_specializing already exists, skipping...
2025-11-02 00:03:15.191 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database codebase_community already exists, skipping...
2025-11-02 00:03:15.403 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database student_club already exists, skipping...
2025-11-02 00:03:15.445 | INFO     | __main__:preprocess_lsh_index_for_one_db:112 - LSH index for database thrombosis_prediction already exists, skipping...
2025-11-02 00:03:15.449 | INFO     | __main__:preprocess_lsh_index:123 - Preprocessed LSH index for 11 databases
2025-11-02 00:03:15.449 | INFO     | __main__:<module>:567 - Step 1 completed - LSH Index Construction: 3.10 seconds
2025-11-02 00:03:15.449 | INFO     | __main__:<module>:570 - ==================================================
2025-11-02 00:03:15.449 | INFO     | __main__:<module>:571 - Starting Step 2: Keyword Extraction and Value Retrieval
✅ 模型 nomic-embed-text 验证成功
ALL IDS: ['california_schools', 'toxicology', 'formula_1', 'superhero', 'european_football_2', 'card_games', 'financial', 'debit_card_specializing', 'codebase_community', 'student_club', 'thrombosis_prediction']
Getting relevant values for all tasks:   0%|          | 0/240 [00:00<?, ?it/s]Getting relevant values for all tasks:   0%|          | 1/240 [02:17<9:09:22, 137.92s/it]Getting relevant values for all tasks:   1%|▏         | 3/240 [02:56<3:18:16, 50.20s/it] Getting relevant values for all tasks:   9%|▉         | 22/240 [18:27<2:58:26, 49.11s/it]Getting relevant values for all tasks:  10%|▉         | 23/240 [19:09<2:55:55, 48.64s/it]Getting relevant values for all tasks:  11%|█         | 26/240 [22:20<3:05:01, 51.88s/it]Getting relevant values for all tasks:  12%|█▏        | 29/240 [22:49<2:27:30, 41.95s/it]Getting relevant values for all tasks:  12%|█▎        | 30/240 [35:00<6:29:34, 111.31s/it]/ssddata/zzhanglc/Alpha-SQL/alphasql/runner/preprocessor.py:273: RuntimeWarning: invalid value encountered in scalar divide
  cosine_similarity = lambda x, y: np.dot(x, y) / (np.linalg.norm(x) * np.linalg.norm(y))
Getting relevant values for all tasks:  13%|█▎        | 31/240 [35:11<5:44:01, 98.76s/it] Getting relevant values for all tasks:  13%|█▎        | 32/240 [35:15<4:52:06, 84.26s/it]Getting relevant values for all tasks:  14%|█▍        | 33/240 [35:24<4:04:07, 70.76s/it]Getting relevant values for all tasks:  14%|█▍        | 34/240 [35:43<3:26:51, 60.25s/it]Getting relevant values for all tasks:  15%|█▌        | 37/240 [36:11<2:03:37, 36.54s/it]Getting relevant values for all tasks:  19%|█▉        | 45/240 [36:19<44:58, 13.84s/it]  Getting relevant values for all tasks:  19%|█▉        | 46/240 [36:21<40:52, 12.64s/it]Getting relevant values for all tasks:  20%|█▉        | 47/240 [36:25<37:08, 11.55s/it]Getting relevant values for all tasks:  20%|██        | 48/240 [36:27<31:57,  9.99s/it]Getting relevant values for all tasks:  21%|██        | 50/240 [36:35<25:52,  8.17s/it]Getting relevant values for all tasks:  21%|██▏       | 51/240 [36:38<22:47,  7.24s/it]Getting relevant values for all tasks:  22%|██▏       | 52/240 [36:57<30:11,  9.64s/it]Getting relevant values for all tasks:  22%|██▏       | 53/240 [37:08<31:06,  9.98s/it]Getting relevant values for all tasks:  25%|██▍       | 59/240 [37:13<11:54,  3.95s/it]Getting relevant values for all tasks:  28%|██▊       | 67/240 [37:16<05:38,  1.96s/it]Getting relevant values for all tasks:  28%|██▊       | 68/240 [37:17<05:17,  1.85s/it]Getting relevant values for all tasks:  29%|██▉       | 69/240 [37:17<04:48,  1.69s/it]Getting relevant values for all tasks:  29%|██▉       | 70/240 [37:18<04:15,  1.50s/it]Getting relevant values for all tasks:  30%|██▉       | 71/240 [37:18<03:38,  1.29s/it]Getting relevant values for all tasks:  32%|███▎      | 78/240 [37:18<01:20,  2.02it/s]Getting relevant values for all tasks:  33%|███▎      | 80/240 [37:18<01:08,  2.33it/s]Getting relevant values for all tasks:  34%|███▍      | 82/240 [37:22<01:54,  1.38it/s]Getting relevant values for all tasks:  35%|███▌      | 84/240 [37:23<01:55,  1.35it/s]Getting relevant values for all tasks:  40%|████      | 96/240 [37:24<00:38,  3.73it/s]Getting relevant values for all tasks:  41%|████      | 98/240 [37:24<00:37,  3.77it/s]Getting relevant values for all tasks:  42%|████▏     | 100/240 [37:26<00:53,  2.61it/s]Getting relevant values for all tasks:  42%|████▎     | 102/240 [37:27<00:48,  2.85it/s]Getting relevant values for all tasks:  43%|████▎     | 103/240 [37:27<00:51,  2.66it/s]Getting relevant values for all tasks:  44%|████▍     | 105/240 [37:28<00:42,  3.16it/s]Getting relevant values for all tasks:  44%|████▍     | 106/240 [37:28<00:38,  3.44it/s]Getting relevant values for all tasks:  45%|████▌     | 108/240 [37:28<00:35,  3.76it/s]Getting relevant values for all tasks:  46%|████▌     | 110/240 [37:29<00:37,  3.44it/s]Getting relevant values for all tasks:  46%|████▋     | 111/240 [37:32<01:40,  1.29it/s]Getting relevant values for all tasks:  48%|████▊     | 115/240 [37:32<00:54,  2.31it/s]Getting relevant values for all tasks:  51%|█████▏    | 123/240 [37:33<00:24,  4.78it/s]Getting relevant values for all tasks:  52%|█████▏    | 125/240 [37:33<00:22,  5.21it/s]Getting relevant values for all tasks:  53%|█████▎    | 127/240 [37:34<00:32,  3.50it/s]Getting relevant values for all tasks:  55%|█████▌    | 133/240 [37:35<00:23,  4.53it/s]Getting relevant values for all tasks:  57%|█████▋    | 136/240 [37:36<00:27,  3.83it/s]Getting relevant values for all tasks:  57%|█████▋    | 137/240 [37:37<00:33,  3.10it/s]Getting relevant values for all tasks:  60%|█████▉    | 143/240 [37:37<00:19,  5.01it/s]Getting relevant values for all tasks:  61%|██████    | 146/240 [37:38<00:22,  4.17it/s]Getting relevant values for all tasks:  61%|██████▏   | 147/240 [37:39<00:29,  3.18it/s]Getting relevant values for all tasks:  63%|██████▎   | 152/240 [37:40<00:18,  4.67it/s]Getting relevant values for all tasks:  65%|██████▌   | 156/240 [37:41<00:17,  4.77it/s]Getting relevant values for all tasks:  66%|██████▋   | 159/240 [37:41<00:16,  4.96it/s]Getting relevant values for all tasks:  67%|██████▋   | 160/240 [37:42<00:18,  4.41it/s]Getting relevant values for all tasks:  67%|██████▋   | 161/240 [37:42<00:23,  3.40it/s]Getting relevant values for all tasks:  68%|██████▊   | 162/240 [37:45<00:51,  1.53it/s]Getting relevant values for all tasks:  68%|██████▊   | 164/240 [37:47<01:02,  1.22it/s]Getting relevant values for all tasks:  72%|███████▎  | 174/240 [37:55<00:52,  1.27it/s]Getting relevant values for all tasks:  74%|███████▍  | 177/240 [37:56<00:44,  1.43it/s]Getting relevant values for all tasks:  78%|███████▊  | 188/240 [37:56<00:17,  2.97it/s]Getting relevant values for all tasks:  80%|███████▉  | 191/240 [37:58<00:17,  2.82it/s]Getting relevant values for all tasks:  80%|████████  | 193/240 [38:01<00:24,  1.92it/s]Getting relevant values for all tasks:  85%|████████▌ | 205/240 [38:02<00:09,  3.65it/s]Getting relevant values for all tasks:  86%|████████▋ | 207/240 [38:04<00:11,  2.81it/s]Getting relevant values for all tasks:  88%|████████▊ | 210/240 [38:05<00:11,  2.65it/s]Getting relevant values for all tasks:  90%|████████▉ | 215/240 [38:05<00:06,  3.69it/s]Getting relevant values for all tasks:  90%|█████████ | 217/240 [38:06<00:07,  3.21it/s]Getting relevant values for all tasks:  91%|█████████ | 218/240 [38:07<00:06,  3.36it/s]Getting relevant values for all tasks:  91%|█████████▏| 219/240 [38:07<00:06,  3.02it/s]Getting relevant values for all tasks:  92%|█████████▏| 220/240 [38:08<00:07,  2.63it/s]Getting relevant values for all tasks:  92%|█████████▎| 222/240 [38:10<00:11,  1.55it/s]Getting relevant values for all tasks:  95%|█████████▍| 227/240 [38:11<00:04,  2.77it/s]Getting relevant values for all tasks:  95%|█████████▌| 229/240 [38:13<00:05,  2.05it/s]Getting relevant values for all tasks:  97%|█████████▋| 232/240 [38:13<00:02,  2.95it/s]Getting relevant values for all tasks:  99%|█████████▉| 237/240 [38:13<00:00,  4.52it/s]Getting relevant values for all tasks: 100%|█████████▉| 239/240 [38:14<00:00,  3.57it/s]Getting relevant values for all tasks: 100%|██████████| 240/240 [38:15<00:00,  2.58it/s]Getting relevant values for all tasks: 100%|██████████| 240/240 [38:15<00:00,  9.57s/it]
2025-11-02 00:41:31.207 | INFO     | __main__:<module>:575 - Step 2 completed - Keyword Extraction and Value Retrieval: 2295.76 seconds
2025-11-02 00:41:31.207 | INFO     | __main__:<module>:578 - ==================================================
2025-11-02 00:41:31.207 | INFO     | __main__:<module>:579 - Starting Step 3: Schema Context Preprocessing
Preprocessing schema context for all tasks: 0it [00:00, ?it/s]Preprocessing schema context for all tasks: 10it [00:00, 98.74it/s]Preprocessing schema context for all tasks: 55it [00:00, 296.83it/s]Preprocessing schema context for all tasks: 106it [00:00, 390.62it/s]Preprocessing schema context for all tasks: 146it [00:00, 389.16it/s]Preprocessing schema context for all tasks: 209it [00:00, 472.67it/s]Preprocessing schema context for all tasks: 240it [00:00, 408.58it/s]
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:583 - Step 3 completed - Schema Context Preprocessing: 0.64 seconds
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:587 - ==================================================
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:588 - Preprocessing pipeline completed!
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:589 - Total time: 2299.51 seconds
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:590 - Step-wise timing details:
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:591 -   - LSH Index Construction: 3.10 seconds
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:592 -   - Keyword Extraction and Value Retrieval: 2295.76 seconds
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:593 -   - Schema Context Preprocessing: 0.64 seconds
2025-11-02 00:41:31.849 | INFO     | __main__:<module>:594 - ==================================================
2025-11-02 00:41:31.850 | INFO     | __main__:<module>:613 - Timing information saved to: preprocessing_timing.json
